name: YouTube Trending Data Fetcher

on:
  workflow_dispatch:
    # GitHub UI üzerinden manuel çalıştırmaya izin verir

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Depoyu Çek
      uses: actions/checkout@v4

    - name: Python Ortamını Kur
      uses: actions/setup-python@v5
      with:
        python-version: '3.x' # Python 3.x sürümünü kullan

    - name: Bağımlılıkları Yükle
      run: |
        python -m pip install --upgrade pip
        pip install requests beautifulsoup4 python-dotenv

    - name: YouTube API Anahtarını Ayarla
      run: |
        echo "YOUTUBE_API_KEY=${{ secrets.YOUTUBE_API_KEY }}" >> $GITHUB_ENV
      # API Anahtarını GitHub Secrets'tan alır.
      # Deponuzun 'Settings' -> 'Secrets and variables' -> 'Actions' bölümünden
      # 'New repository secret' butonuna tıklayarak YOUTUBE_API_KEY adında bir secret oluşturmanız gerekmektedir.

    - name: Komut Dosyasını Çalıştır ve Verileri Oluştur
      run: |
        python country_youtube_data.py

    - name: Değişiklikleri Kaydet
      uses: EndBug/add-and-commit@v9
      with:
        author_name: GitHub Actions Bot
        author_email: github-actions[bot]@users.noreply.github.com
        message: 'Manuel tetiklenen YouTube trend verileri güncellendi.'
        add: 'toptubelist/countries_html/' # Bu klasördeki tüm değişiklikleri ekler
